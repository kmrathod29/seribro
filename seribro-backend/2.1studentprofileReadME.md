# ğŸ“ SERIBRO Backend: Student Profile Management

**Phase:** 2.1  
**Base URL:** `http://localhost:7000/api/student`  
**Authentication:** JWT Token + Role-Based Access Control  
**Last Updated:** November 18, 2025

---

## ğŸ“‹ Table of Contents

- [Overview](#-overview)
- [Project Structure](#-project-structure)
- [Database Models](#-database-models)
- [Middleware](#-middleware-layer)
- [Controllers & Business Logic](#-controllers--business-logic)
- [Utility Functions](#-utility-functions)
- [API Endpoints](#-api-endpoints)
- [Testing Guide](#-testing-guide)
- [Workflow](#-complete-workflow)

---

## ğŸš€ Overview

This phase implements the complete backend infrastructure for **student profile creation, updates, and document management**. The system ensures:

âœ… Student profiles are complete before job applications  
âœ… All documents (resume, college ID, certificates) are verified  
âœ… Profile completion tracking with real-time status  
âœ… Secure file uploads to Cloudinary  
âœ… Role-based access control for students only  

### Key Features

| Feature | Description |
|---------|-------------|
| **Profile Management** | Create, read, and update student profiles |
| **Document Upload** | Resume, college ID, and certificates with Cloudinary integration |
| **Project Showcase** | Add up to 5 projects with validation (minimum 3 required) |
| **Skills Tracking** | Technical skills, soft skills, and primary skills management |
| **Profile Completion** | Real-time calculation of profile completion percentage |
| **Verification Flow** | Submit for admin review when 100% complete |
| **Dashboard Analytics** | Student dashboard with alerts and completion status |

---

## ğŸ“‚ Project Structure

```
seribro-backend/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ dbconection.js              # Database configuration
â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”œâ”€â”€ authController.js           # Authentication logic
â”‚   â”‚   â””â”€â”€ StudentProfileController.js # Profile operations
â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â”œâ”€â”€ authMiddleware.js           # JWT verification
â”‚   â”‚   â”œâ”€â”€ uploadMiddleware.js         # Multer configuration
â”‚   â”‚   â””â”€â”€ student/
â”‚   â”‚       â”œâ”€â”€ isVerified.js           # Email verification check
â”‚   â”‚       â”œâ”€â”€ roleMiddleware.js       # Role-based access control
â”‚   â”‚       â”œâ”€â”€ validationMiddleware.js # Request validation
â”‚   â”‚       â””â”€â”€ profileCompletionCheck.js # Completion validation
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ Student.js                  # Student schema
â”‚   â”‚   â”œâ”€â”€ StudentProfile.js           # Profile data schema
â”‚   â”‚   â”œâ”€â”€ User.js                     # Base user schema
â”‚   â”‚   â”œâ”€â”€ Company.js                  # Company schema
â”‚   â”‚   â””â”€â”€ OTP.js                      # OTP verification schema
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ authRoutes.js               # Auth endpoints
â”‚   â”‚   â””â”€â”€ studentProfileRoute.js      # Profile endpoints
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ generateOTP.js              # OTP generation
â”‚   â”‚   â”œâ”€â”€ generateToken.js            # JWT token creation
â”‚   â”‚   â”œâ”€â”€ sendEmail.js                # Email service
â”‚   â”‚   â””â”€â”€ students/
â”‚   â”‚       â”œâ”€â”€ sendResponse.js         # Response formatter
â”‚   â”‚       â”œâ”€â”€ uploadToCloudinary.js   # File upload handler
â”‚   â”‚       â”œâ”€â”€ validateProjectData.js  # Project validation
â”‚   â”‚       â”œâ”€â”€ checkGithubLink.js      # GitHub URL validation
â”‚   â”‚       â””â”€â”€ calculateProfileCompletion.js # Completion calculator
â”‚   â”œâ”€â”€ uploads/                        # Temporary file storage
â”‚   â””â”€â”€ models/
â”œâ”€â”€ server.js                           # Entry point
â””â”€â”€ package.json
```

---

## ğŸ“Š Database Models

### 1. **User Model** (Base Schema)
Parent model for all user types (Student, Company, Admin)

```javascript
{
  email: String (unique),
  password: String (hashed),
  role: String (enum: ['student', 'company', 'admin']),
  createdAt: Date,
  updatedAt: Date
}
```

---

### 2. **Student Model**
Student authentication and verification tracking

```javascript
{
  userId: ObjectId (ref: User),
  isVerified: Boolean (OTP verification status),
  phone: String,
  createdAt: Date,
  updatedAt: Date
}
```

---

### 3. **StudentProfile Model**
Complete student profile with all details and documents

```javascript
{
  studentId: ObjectId (ref: Student),
  
  // Basic Information
  basicInfo: {
    fullName: String,
    phone: String,
    collegeName: String,
    branch: String,
    semester: Number,
    dateOfBirth: Date
  },
  
  // Skills
  skills: {
    technical: [String],      // ["JavaScript", "React", "Node.js"]
    soft: [String],           // ["Communication", "Leadership"]
    primarySkills: [String]   // ["Web Development", "Backend"]
  },
  
  // Tech Stack
  techStack: [String],        // ["React", "Express", "MongoDB", "AWS"]
  
  // Projects (min 3, max 5)
  projects: [{
    _id: ObjectId,
    title: String,
    description: String,
    link: String (GitHub),
    technologies: [String],
    createdAt: Date,
    updatedAt: Date
  }],
  
  // Document URLs (from Cloudinary)
  documents: {
    resume: String (URL),
    collegeId: String (URL),
    certificates: [String]    // Array of certificate URLs
  },
  
  // Profile Status
  profileCompletion: Number (0-100),
  verificationStatus: String (enum: ['incomplete', 'pending', 'verified', 'rejected']),
  
  // Metadata
  createdAt: Date,
  updatedAt: Date,
  submittedForVerificationAt: Date
}
```

---

## ğŸ” Middleware Layer

### Authentication & Authorization Flow

| Middleware | Purpose | Impact | Order |
|-----------|---------|--------|-------|
| `authMiddleware` | Validates JWT token & attaches `req.user` | Protects all student routes | 1st |
| `roleMiddleware('student')` | Ensures user has student role | Route-specific access | 2nd |
| `isVerified` | Checks OTP verification status | Blocks unverified students | 3rd |
| `validationMiddleware` | Validates request body schema | Prevents invalid data | 4th |
| `uploadMiddleware` | Handles multipart file uploads | Stores files temporarily | On-demand |
| `profileCompletionCheck` | Validates 100% completion before verification | Submission validation | Route-specific |

### Middleware Files & Functions

```javascript
// 1. JWT Token Verification
authMiddleware(req, res, next)
// Usage: router.get('/profile', authMiddleware, getProfile)

// 2. Role-Based Access
roleMiddleware(role)(req, res, next)
// Usage: router.get('/profile', authMiddleware, roleMiddleware('student'), getProfile)

// 3. Email Verification Check
isVerified(req, res, next)
// Usage: router.put('/profile/basic', authMiddleware, isVerified, updateBasicInfo)

// 4. Input Validation
validationMiddleware(schema)(req, res, next)
// Usage: router.put('/profile/skills', authMiddleware, validationMiddleware(skillsSchema), updateSkills)

// 5. File Upload Handler (Multer)
uploadMiddleware.single('fieldName')
uploadMiddleware.multiple('fieldName')
// Usage: router.post('/profile/resume', authMiddleware, uploadMiddleware.single('resume'), uploadResume)

// 6. Profile Completion Validator
profileCompletionCheck(req, res, next)
// Usage: router.post('/profile/submit-verification', authMiddleware, profileCompletionCheck, submitForVerification)
```

---

## ğŸ’» Controllers & Business Logic

### StudentProfileController.js

Complete list of all controller functions with descriptions and use cases.

#### 1. **getProfile()**
Fetches or creates student profile

```javascript
Route:    GET /profile
Auth:     âœ… Required
Role:     student
Input:    None
Output:   { success: true, data: { basicInfo, skills, projects, documents, ... } }
Logic:    If profile doesn't exist â†’ Create new â†’ Return profile
Status:   Returns current profile completion %
```

---

#### 2. **getDashboard()**
Returns profile summary and alerts

```javascript
Route:    GET /dashboard
Auth:     âœ… Required
Role:     student
Input:    None
Output:   {
             success: true,
             data: {
               profileCompletion: 45,
               verificationStatus: 'incomplete',
               alerts: [
                 { type: 'warning', message: 'Add 2 more projects' },
                 { type: 'warning', message: 'Upload resume' }
               ],
               completedSteps: ['basicInfo', 'skills'],
               pendingSteps: ['projects', 'documents']
             }
           }
Logic:    Calculates completion % and generates alerts
```

---

#### 3. **updateBasicInfo()**
Updates student basic information

```javascript
Route:    PUT /profile/basic
Auth:     âœ… Required
Role:     student
Input:    {
             fullName: String,
             phone: String,
             collegeName: String,
             branch: String,
             semester: Number,
             dateOfBirth: Date
           }
Output:   { success: true, data: { updated basicInfo object }, profileCompletion: Number }
Validation: Phone format, College name not empty
Error:    Returns 400 if validation fails
```

---

#### 4. **updateSkills()**
Updates technical and soft skills

```javascript
Route:    PUT /profile/skills
Auth:     âœ… Required
Role:     student
Input:    {
             technical: [String],      // ["JavaScript", "React"]
             soft: [String],           // ["Communication"]
             primarySkills: [String]   // ["Web Development"]
           }
Output:   { success: true, data: { skills object }, profileCompletion: Number }
Validation: At least 1 skill in each category
Error:    Returns 400 if arrays empty
```

---

#### 5. **updateTechStack()**
Updates technical stack/technologies

```javascript
Route:    PUT /profile/tech
Auth:     âœ… Required
Role:     student
Input:    { techStack: ["React", "Node.js", "MongoDB", "AWS"] }
Output:   { success: true, data: ["React", "Node.js", "MongoDB", "AWS"], profileCompletion: Number }
Validation: At least 3 technologies required
Error:    Returns 400 if less than 3 items
```

---

#### 6. **addProject()**
Adds new project to profile

```javascript
Route:    POST /profile/projects
Auth:     âœ… Required
Role:     student
Input:    {
             title: String,
             description: String,
             link: String (GitHub URL),
             technologies: [String]
           }
Output:   { success: true, data: { _id, title, description, link, ... } }
Limits:   Max 5 projects per profile
Validation: 
  - Title not empty
  - Description min 10 characters
  - Valid GitHub URL
Error:    Returns 400 if validation fails or limit exceeded
```

---

#### 7. **updateProject()**
Updates existing project by ID

```javascript
Route:    PUT /profile/projects/:id
Auth:     âœ… Required
Role:     student
Input:    { title: String, description: String, link: String, technologies: [String] }
Output:   { success: true, data: { updated project object } }
Validation: Project must exist in profile
Error:    Returns 404 if project not found
```

---

#### 8. **deleteProject()**
Deletes project from profile

```javascript
Route:    DELETE /profile/projects/:id
Auth:     âœ… Required
Role:     student
Input:    None
Output:   { success: true, data: { projectId: ObjectId } }
Constraint: Minimum 3 projects must remain
Error:    Returns 400 if deletion would leave < 3 projects
          Returns 404 if project not found
```

---

#### 9. **uploadResume()**
Uploads resume to Cloudinary

```javascript
Route:    POST /profile/resume
Auth:     âœ… Required
Role:     student
Upload:   multipart/form-data
Field:    resume (File: PDF only, Max 5MB)
Output:   { success: true, data: { path: "https://cloudinary-url/resume.pdf" } }
Logic:    
  1. Validate file type (PDF)
  2. Validate file size (â‰¤ 5MB)
  3. Upload to Cloudinary
  4. Save URL in StudentProfile
  5. Return Cloudinary URL
Error:    Returns 400 for invalid file type/size
          Returns 500 if upload fails
```

---

#### 10. **uploadCollegeId()**
Uploads college ID document

```javascript
Route:    POST /profile/college-id
Auth:     âœ… Required
Role:     student
Upload:   multipart/form-data
Field:    collegeId (File: Image/PDF, Max 5MB)
Output:   { success: true, data: { path: "https://cloudinary-url/college-id.jpg" } }
Validation: Image (JPG/PNG) or PDF only
Error:    Returns 400 for invalid format
```

---

#### 11. **uploadCertificates()**
Uploads multiple certificate files

```javascript
Route:    POST /profile/certificates
Auth:     âœ… Required
Role:     student
Upload:   multipart/form-data
Field:    certificates (Files: Multiple, PDF/Image, Max 5MB each)
Output:   { 
             success: true, 
             data: [
               { path: "https://cloudinary-url/cert1.pdf" },
               { path: "https://cloudinary-url/cert2.jpg" }
             ] 
           }
Limits:   Max 10 certificates
Validation: Each file â‰¤ 5MB
Error:    Returns 400 if limit exceeded or invalid files
```

---

#### 12. **submitForVerification()**
Submits profile for admin verification

```javascript
Route:    POST /profile/submit-verification
Auth:     âœ… Required
Role:     student
Input:    None (No body required)
Output:   { success: true, message: "Profile submitted for verification. Admin will review within 24 hours." }
PreCheck: profileCompletionCheck middleware validates:
  âœ“ Basic info complete
  âœ“ At least 3 projects added
  âœ“ Resume uploaded
  âœ“ College ID uploaded
  âœ“ At least 1 certificate uploaded
Logic:
  1. Verify profile 100% complete
  2. Update verificationStatus to 'pending'
  3. Record submittedForVerificationAt timestamp
  4. Send confirmation email
Error:    Returns 400 if profile incomplete
          Returns 422 if already submitted for verification
```

---

## ğŸ› ï¸ Utility Functions

### Response Handler
```javascript
// utils/student/sendResponse.js
sendResponse(res, statusCode, success, message, data = null)

// Usage:
sendResponse(res, 200, true, 'Profile fetched successfully', profileData)
sendResponse(res, 400, false, 'Validation failed', { field: 'email', error: 'Invalid email' })
```

---

### File Upload to Cloudinary
```javascript
// utils/student/uploadToCloudinary.js
uploadToCloudinary(filePath, folderName, resourceType)

// Usage:
const url = await uploadToCloudinary('./uploads/resume.pdf', 'student-resumes', 'auto')
// Returns: "https://res.cloudinary.com/your-cloud/image/upload/v123/student-resumes/resume.pdf"
```

---

### Project Validation
```javascript
// utils/student/validateProjectData.js
validateProjectData(projectData)

// Returns: { isValid: Boolean, errors: [String] }
// Checks: Title, Description (min 10 chars), GitHub link format
```

---

### GitHub Link Validation
```javascript
// utils/student/checkGithubLink.js
checkGithubLink(url)

// Returns: { isValid: Boolean, message: String }
// Checks: Valid GitHub URL format and HTTP response (mock)
```

---

### Profile Completion Calculator
```javascript
// utils/student/calculateProfileCompletion.js
calculateProfileCompletion(profile)

// Returns: Number (0-100)
// Calculation:
// - Basic Info (20%): Name, Phone, College, Branch, Semester
// - Skills (20%): Technical + Soft + Primary
// - Tech Stack (15%): At least 3 technologies
// - Projects (20%): At least 3 projects (max 5)
// - Resume (10%): PDF uploaded
// - College ID (10%): Image/PDF uploaded
// - Certificates (5%): At least 1 uploaded
```

---

## ğŸŒ API Endpoints Reference

**Base URL:** `http://localhost:7000/api/student`

### Profile Management

#### GET /profile
Fetches or creates student profile
```
Method:   GET
URL:      http://localhost:7000/api/student/profile
Auth:     Required (JWT)
Body:     None

Response (200):
{
  "success": true,
  "data": {
    "_id": "65abc123def456",
    "basicInfo": {
      "fullName": "Aman Singh",
      "phone": "9876543210",
      "collegeName": "IIT Delhi",
      "branch": "Computer Science",
      "semester": 6
    },
    "skills": {
      "technical": ["JavaScript", "React"],
      "soft": ["Communication"],
      "primarySkills": ["Web Development"]
    },
    "techStack": ["React", "Node.js", "MongoDB"],
    "projects": [
      {
        "_id": "65xyz789",
        "title": "E-Commerce Platform",
        "description": "Full-stack e-commerce application",
        "link": "https://github.com/user/ecommerce",
        "technologies": ["React", "Node.js", "MongoDB"]
      }
    ],
    "documents": {
      "resume": "https://cloudinary-url/resume.pdf",
      "collegeId": "https://cloudinary-url/college-id.jpg",
      "certificates": ["https://cloudinary-url/cert1.pdf"]
    },
    "profileCompletion": 65,
    "verificationStatus": "incomplete"
  }
}
```

---

#### GET /dashboard
Returns profile summary and alerts
```
Method:   GET
URL:      http://localhost:7000/api/student/dashboard
Auth:     Required (JWT)
Body:     None

Response (200):
{
  "success": true,
  "data": {
    "profileCompletion": 65,
    "verificationStatus": "incomplete",
    "lastUpdated": "2025-11-18T10:30:00Z",
    "alerts": [
      { "type": "warning", "message": "Add 2 more projects (current: 3, required: 5)" },
      { "type": "warning", "message": "Upload certificates for better profile strength" }
    ],
    "completedSteps": [
      "basicInfo",
      "skills",
      "techStack",
      "projects",
      "resume",
      "collegeId"
    ],
    "pendingSteps": ["certificates"]
  }
}
```

---

### Basic Information Updates

#### PUT /profile/basic
Updates student basic information
```
Method:   PUT
URL:      http://localhost:7000/api/student/profile/basic
Auth:     Required (JWT)
Body:     {
             "fullName": "Aman Singh",
             "phone": "9876543210",
             "collegeName": "IIT Delhi",
             "branch": "Computer Science",
             "semester": 6,
             "dateOfBirth": "2003-05-15"
           }

Response (200):
{
  "success": true,
  "data": {
    "fullName": "Aman Singh",
    "phone": "9876543210",
    "collegeName": "IIT Delhi",
    "branch": "Computer Science",
    "semester": 6,
    "dateOfBirth": "2003-05-15"
  },
  "profileCompletion": 35
}
```

---

### Skills Management

#### PUT /profile/skills
Updates technical and soft skills
```
Method:   PUT
URL:      http://localhost:7000/api/student/profile/skills
Auth:     Required (JWT)
Body:     {
             "technical": ["JavaScript", "React", "Node.js"],
             "soft": ["Communication", "Leadership", "Problem Solving"],
             "primarySkills": ["Web Development", "Full-Stack Development"]
           }

Response (200):
{
  "success": true,
  "data": {
    "technical": ["JavaScript", "React", "Node.js"],
    "soft": ["Communication", "Leadership", "Problem Solving"],
    "primarySkills": ["Web Development", "Full-Stack Development"]
  },
  "profileCompletion": 55
}
```

---

#### PUT /profile/tech
Updates technical stack
```
Method:   PUT
URL:      http://localhost:7000/api/student/profile/tech
Auth:     Required (JWT)
Body:     {
             "techStack": ["React", "Express.js", "MongoDB", "AWS", "Docker"]
           }

Response (200):
{
  "success": true,
  "data": ["React", "Express.js", "MongoDB", "AWS", "Docker"],
  "profileCompletion": 70
}
```

---

### Project Management

#### POST /profile/projects
Adds new project to profile
```
Method:   POST
URL:      http://localhost:7000/api/student/profile/projects
Auth:     Required (JWT)
Body:     {
             "title": "E-Commerce Platform",
             "description": "Full-stack e-commerce application with React frontend and Node.js backend",
             "link": "https://github.com/user/ecommerce",
             "technologies": ["React", "Node.js", "MongoDB", "Stripe"]
           }

Response (201):
{
  "success": true,
  "data": {
    "_id": "65xyz789",
    "title": "E-Commerce Platform",
    "description": "Full-stack e-commerce application with React frontend and Node.js backend",
    "link": "https://github.com/user/ecommerce",
    "technologies": ["React", "Node.js", "MongoDB", "Stripe"],
    "createdAt": "2025-11-18T10:30:00Z"
  },
  "profileCompletion": 75
}

Error (400): Project limit exceeded (max 5)
Error (400): Invalid GitHub URL format
```

---

#### PUT /profile/projects/:id
Updates existing project
```
Method:   PUT
URL:      http://localhost:7000/api/student/profile/projects/65xyz789
Auth:     Required (JWT)
Body:     {
             "title": "E-Commerce Platform V2",
             "description": "Enhanced e-commerce with payment gateway"
           }

Response (200):
{
  "success": true,
  "data": {
    "_id": "65xyz789",
    "title": "E-Commerce Platform V2",
    "description": "Enhanced e-commerce with payment gateway",
    "link": "https://github.com/user/ecommerce",
    "technologies": ["React", "Node.js", "MongoDB", "Stripe"]
  }
}

Error (404): Project not found
```

---

#### DELETE /profile/projects/:id
Deletes project from profile
```
Method:   DELETE
URL:      http://localhost:7000/api/student/profile/projects/65xyz789
Auth:     Required (JWT)
Body:     None

Response (200):
{
  "success": true,
  "data": {
    "projectId": "65xyz789",
    "message": "Project deleted successfully"
  }
}

Error (400): Cannot delete - minimum 3 projects required
Error (404): Project not found
```

---

### Document Uploads

#### POST /profile/resume
Uploads resume (PDF)
```
Method:   POST
URL:      http://localhost:7000/api/student/profile/resume
Auth:     Required (JWT)
Upload:   multipart/form-data
Field:    resume (File: PDF, Max 5MB)

Response (201):
{
  "success": true,
  "data": {
    "path": "https://res.cloudinary.com/your-cloud/raw/upload/v123/student-resumes/resume.pdf",
    "fileName": "resume.pdf",
    "uploadedAt": "2025-11-18T10:30:00Z"
  },
  "profileCompletion": 80
}

Error (400): File must be PDF
Error (400): File size exceeds 5MB
Error (500): Upload failed
```

---

#### POST /profile/college-id
Uploads college ID
```
Method:   POST
URL:      http://localhost:7000/api/student/profile/college-id
Auth:     Required (JWT)
Upload:   multipart/form-data
Field:    collegeId (File: Image/PDF, Max 5MB)

Response (201):
{
  "success": true,
  "data": {
    "path": "https://res.cloudinary.com/your-cloud/image/upload/v123/student-ids/college-id.jpg",
    "fileName": "college-id.jpg",
    "uploadedAt": "2025-11-18T10:30:00Z"
  },
  "profileCompletion": 90
}

Error (400): Invalid file type
Error (400): File size exceeds 5MB
```

---

#### POST /profile/certificates
Uploads multiple certificates
```
Method:   POST
URL:      http://localhost:7000/api/student/profile/certificates
Auth:     Required (JWT)
Upload:   multipart/form-data
Field:    certificates (Files: Multiple PDF/Images, Max 5MB each)

Response (201):
{
  "success": true,
  "data": [
    {
      "path": "https://res.cloudinary.com/your-cloud/raw/upload/v123/certificates/cert1.pdf",
      "fileName": "cert1.pdf"
    },
    {
      "path": "https://res.cloudinary.com/your-cloud/image/upload/v123/certificates/cert2.jpg",
      "fileName": "cert2.jpg"
    }
  ],
  "profileCompletion": 100
}

Error (400): Max 10 certificates allowed
Error (400): File size exceeds 5MB
```

---

### Verification

#### POST /profile/submit-verification
Submits profile for admin verification
```
Method:   POST
URL:      http://localhost:7000/api/student/profile/submit-verification
Auth:     Required (JWT)
Body:     None

Response (200):
{
  "success": true,
  "message": "Profile submitted for verification successfully! Our team will review your profile within 24 hours.",
  "verificationStatus": "pending",
  "submittedAt": "2025-11-18T10:30:00Z"
}

Error (400): Profile must be 100% complete before submission
Error (422): Profile already submitted for verification
Error (422): Profile is already verified or rejected
```

---

## ğŸ§ª Testing Guide (Thunder Client / Postman)

### Prerequisites
- âœ… Node.js server running on `http://localhost:7000`
- âœ… MongoDB connected and configured
- âœ… JWT authentication implemented
- âœ… Multer configured for file uploads
- âœ… Cloudinary API keys set (or mock implementation)

### Setup Steps

1. **Install Dependencies**
   ```bash
   npm install express multer dotenv mongodb jsonwebtoken
   ```

2. **Create Uploads Folder**
   ```bash
   mkdir uploads
   ```

3. **Start Server**
   ```bash
   npm start
   # Server running on http://localhost:7000
   ```

---

## ğŸ“ Complete Testing Workflow

### Step 1: Login & Get JWT Token
```
Method:   POST
URL:      http://localhost:7000/api/auth/login
Body:     {
             "email": "student@example.com",
             "password": "password123"
           }

Response:
{
  "success": true,
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": { "id": "65...", "role": "student" }
}

ğŸ’¡ Copy the token â†’ Use in Authorization header for all following requests
```

---

### Step 2: Fetch/Create Profile
```
Method:   GET
URL:      http://localhost:7000/api/student/profile
Headers:  Authorization: Bearer <JWT_TOKEN>

âœ… Expected: Creates new profile with 0% completion
```

---

### Step 3: Update Basic Information
```
Method:   PUT
URL:      http://localhost:7000/api/student/profile/basic
Headers:  Authorization: Bearer <JWT_TOKEN>
Body:     {
             "fullName": "Aman Singh",
             "phone": "9876543210",
             "collegeName": "IIT Delhi",
             "branch": "Computer Science",
             "semester": 6
           }

âœ… Expected: Profile completion increases to ~20%
```

---

### Step 4: Update Skills
```
Method:   PUT
URL:      http://localhost:7000/api/student/profile/skills
Headers:  Authorization: Bearer <JWT_TOKEN>
Body:     {
             "technical": ["JavaScript", "React", "Node.js"],
             "soft": ["Communication", "Leadership"],
             "primarySkills": ["Web Development", "Full-Stack"]
           }

âœ… Expected: Profile completion increases to ~40%
```

---

### Step 5: Update Technical Stack
```
Method:   PUT
URL:      http://localhost:7000/api/student/profile/tech
Headers:  Authorization: Bearer <JWT_TOKEN>
Body:     {
             "techStack": ["React", "Express.js", "MongoDB", "AWS"]
           }

âœ… Expected: Profile completion increases to ~55%
```

---

### Step 6: Add Project 1
```
Method:   POST
URL:      http://localhost:7000/api/student/profile/projects
Headers:  Authorization: Bearer <JWT_TOKEN>
Body:     {
             "title": "E-Commerce Platform",
             "description": "Full-stack e-commerce application built with React and Node.js",
             "link": "https://github.com/user/ecommerce",
             "technologies": ["React", "Node.js", "MongoDB"]
           }

âœ… Save the returned _id: "65abc001"
âœ… Expected: Profile completion increases
```

---

### Step 7: Add Project 2
```
Method:   POST
URL:      http://localhost:7000/api/student/profile/projects
Headers:  Authorization: Bearer <JWT_TOKEN>
Body:     {
             "title": "Chat Application",
             "description": "Real-time chat app with Socket.io",
             "link": "https://github.com/user/chat-app",
             "technologies": ["Socket.io", "React", "Express"]
           }

âœ… Save the returned _id: "65abc002"
```

---

### Step 8: Add Project 3
```
Method:   POST
URL:      http://localhost:7000/api/student/profile/projects
Headers:  Authorization: Bearer <JWT_TOKEN>
Body:     {
             "title": "Machine Learning Model",
             "description": "Predictive analytics model using Python",
             "link": "https://github.com/user/ml-model",
             "technologies": ["Python", "TensorFlow", "Pandas"]
           }

âœ… Save the returned _id: "65abc003"
âœ… Now you have minimum 3 projects required
```

---

### Step 9: Upload Resume
```
Method:   POST
URL:      http://localhost:7000/api/student/profile/resume
Headers:  Authorization: Bearer <JWT_TOKEN>
Upload:   multipart/form-data
Field:    resume (select any PDF file)

âœ… Expected: Resume URL saved in documents.resume
âœ… Expected: Profile completion increases to ~85%
```

---

### Step 10: Upload College ID
```
Method:   POST
URL:      http://localhost:7000/api/student/profile/college-id
Headers:  Authorization: Bearer <JWT_TOKEN>
Upload:   multipart/form-data
Field:    collegeId (select an image or PDF)

âœ… Expected: College ID URL saved in documents.collegeId
âœ… Expected: Profile completion increases to ~95%
```

---

### Step 11: Upload Certificates
```
Method:   POST
URL:      http://localhost:7000/api/student/profile/certificates
Headers:  Authorization: Bearer <JWT_TOKEN>
Upload:   multipart/form-data
Field:    certificates (select multiple files)

âœ… Expected: Certificate URLs saved in documents.certificates array
âœ… Expected: Profile completion reaches 100%
```

---

### Step 12: Check Dashboard
```
Method:   GET
URL:      http://localhost:7000/api/student/dashboard
Headers:  Authorization: Bearer <JWT_TOKEN>

âœ… Expected: 
{
  "profileCompletion": 100,
  "verificationStatus": "incomplete",
  "alerts": [],
  "completedSteps": [
    "basicInfo",
    "skills",
    "techStack",
    "projects",
    "resume",
    "collegeId",
    "certificates"
  ]
}
```

---

### Step 13: Submit for Verification âœ¨
```
Method:   POST
URL:      http://localhost:7000/api/student/profile/submit-verification
Headers:  Authorization: Bearer <JWT_TOKEN>
Body:     None

âœ… Expected:
{
  "success": true,
  "message": "Profile submitted for verification successfully!",
  "verificationStatus": "pending"
}
```

---

### Step 14: Test Update Project
```
Method:   PUT
URL:      http://localhost:7000/api/student/profile/projects/65abc001
Headers:  Authorization: Bearer <JWT_TOKEN>
Body:     {
             "title": "E-Commerce Platform V2",
             "description": "Enhanced with payment gateway integration"
           }

âœ… Expected: Project updated successfully
```

---

### Step 15: Test Delete Project
```
Method:   DELETE
URL:      http://localhost:7000/api/student/profile/projects/65abc001
Headers:  Authorization: Bearer <JWT_TOKEN>
Body:     None

âœ… Expected: Project deleted successfully
âš ï¸  NOTE: Still have 2 projects left, so deletion succeeds
```

---

### Step 16: Try Invalid Delete (Should Fail)
```
Method:   DELETE
URL:      http://localhost:7000/api/student/profile/projects/65abc002
Headers:  Authorization: Bearer <JWT_TOKEN>
Body:     None

âŒ Expected Error:
{
  "success": false,
  "message": "Cannot delete project. Minimum 3 projects required."
}
```

---

## ğŸ”„ Complete Workflow Summary

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    STUDENT PROFILE WORKFLOW                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. LOGIN
   â””â”€> Get JWT Token

2. CREATE/FETCH PROFILE
   â””â”€> Initialize StudentProfile (0% complete)

3. BUILD PROFILE (Incremental Steps)
   â”œâ”€> Update Basic Info (20%)
   â”œâ”€> Update Skills (20%)
   â”œâ”€> Update Tech Stack (15%)
   â”œâ”€> Add 3+ Projects (20%)
   â”œâ”€> Upload Resume (10%)
   â”œâ”€> Upload College ID (10%)
   â””â”€> Upload Certificates (5%)

4. VERIFY COMPLETION
   â””â”€> Check Dashboard (Must show 100%)

5. SUBMIT FOR VERIFICATION
   â”œâ”€> profileCompletionCheck middleware validates
   â”œâ”€> Updates verificationStatus to 'pending'
   â””â”€> Sends confirmation email

6. OPTIONAL: MANAGE PROJECTS
   â”œâ”€> Update Project Details
   â””â”€> Delete Project (with minimum constraint)

7. ADMIN REVIEW (Not in this phase)
   â””â”€> Admin verifies documents and updates status
```

---

## ğŸ¯ Key Constraints & Business Rules

### Profile Completion Rules
| Component | Required | Points | Status |
|-----------|----------|--------|--------|
| Basic Info | âœ… Yes | 20% | Name, College, Phone, Branch, Semester |
| Skills | âœ… Yes | 20% | Technical, Soft, Primary (min 1 each) |
| Tech Stack | âœ… Yes | 15% | Min 3 technologies required |
| Projects | âœ… Yes | 20% | Min 3, Max 5 projects |
| Resume | âœ… Yes | 10% | PDF format, Max 5MB |
| College ID | âœ… Yes | 10% | Image/PDF format, Max 5MB |
| Certificates | âœ… Yes | 5% | Min 1, Max 10 files |

### Project Management Constraints
- **Minimum:** 3 projects required
- **Maximum:** 5 projects allowed
- **Deletion Rule:** Cannot delete if it would leave < 3 projects
- **Validation:** Title, Description (min 10 chars), GitHub URL format

### File Upload Limits
| File Type | Max Size | Count |
|-----------|----------|-------|
| Resume | 5MB | 1 |
| College ID | 5MB | 1 |
| Certificates | 5MB | Max 10 |

### Verification Flow
```
Profile 100% Complete
       â†“
Submit for Verification (POST endpoint)
       â†“
profileCompletionCheck validates everything
       â†“
Status â†’ 'pending'
       â†“
Admin reviews (Next phase)
       â†“
Status â†’ 'verified' or 'rejected'
```

---

## ğŸ“š Database Schema Example

```javascript
// Actual MongoDB document structure

{
  "_id": ObjectId("65abc123def456"),
  "studentId": ObjectId("64xyz789"),
  
  "basicInfo": {
    "fullName": "Aman Singh",
    "phone": "9876543210",
    "collegeName": "IIT Delhi",
    "branch": "Computer Science",
    "semester": 6,
    "dateOfBirth": ISODate("2003-05-15")
  },
  
  "skills": {
    "technical": ["JavaScript", "React", "Node.js", "MongoDB"],
    "soft": ["Communication", "Leadership", "Problem Solving"],
    "primarySkills": ["Web Development", "Full-Stack Development"]
  },
  
  "techStack": ["React", "Express.js", "MongoDB", "AWS", "Docker"],
  
  "projects": [
    {
      "_id": ObjectId("65proj001"),
      "title": "E-Commerce Platform",
      "description": "Full-stack e-commerce application",
      "link": "https://github.com/user/ecommerce",
      "technologies": ["React", "Node.js", "MongoDB"],
      "createdAt": ISODate("2025-11-15"),
      "updatedAt": ISODate("2025-11-18")
    }
  ],
  
  "documents": {
    "resume": "https://res.cloudinary.com/cloud/raw/upload/v123/resume.pdf",
    "collegeId": "https://res.cloudinary.com/cloud/image/upload/v456/college-id.jpg",
    "certificates": [
      "https://res.cloudinary.com/cloud/raw/upload/v789/cert1.pdf"
    ]
  },
  
  "profileCompletion": 100,
  "verificationStatus": "pending",
  "submittedForVerificationAt": ISODate("2025-11-18T10:30:00Z"),
  
  "createdAt": ISODate("2025-11-10"),
  "updatedAt": ISODate("2025-11-18T10:30:00Z")
}
```

---

## ğŸš¨ Error Codes & Messages

| Status | Code | Scenario | Response |
|--------|------|----------|----------|
| 200 | OK | Successful GET/PUT | `{ success: true, data: {...} }` |
| 201 | CREATED | Successful POST | `{ success: true, data: {...} }` |
| 400 | BAD_REQUEST | Validation failed | `{ success: false, message: "..." }` |
| 401 | UNAUTHORIZED | No JWT token | `{ success: false, message: "Unauthorized" }` |
| 403 | FORBIDDEN | Wrong role/not verified | `{ success: false, message: "Access denied" }` |
| 404 | NOT_FOUND | Resource not found | `{ success: false, message: "Project not found" }` |
| 422 | UNPROCESSABLE | Business logic error | `{ success: false, message: "Profile already submitted" }` |
| 500 | SERVER_ERROR | Upload/DB error | `{ success: false, message: "Server error" }` |

---

## ğŸ“Œ Quick Reference

### Common Request Headers
```
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
Content-Type: application/json
```

### File Upload (Multipart)
```
Content-Type: multipart/form-data
Field Name: resume / collegeId / certificates
```

### Profile Completion Calculation
```
Total = (BasicInfo Ã— 0.2) + (Skills Ã— 0.2) + (TechStack Ã— 0.15) 
      + (Projects Ã— 0.2) + (Resume Ã— 0.1) + (CollegeID Ã— 0.1) 
      + (Certificates Ã— 0.05)
```

---

## ğŸ”— Related Files

- **Server Entry:** `/server.js`
- **Auth Routes:** `/backend/routes/authRoutes.js`
- **Database Config:** `/backend/config/dbconection.js`
- **Student Models:** `/backend/models/StudentProfile.js`, `/backend/models/Student.js`
- **Middleware:** `/backend/middleware/student/*.js`

---

## ğŸ“ Support & Questions

For issues or questions regarding:
- **API Endpoints:** Check the endpoint tables above
- **Testing:** Follow the step-by-step testing guide
- **Database:** Ensure MongoDB connection is active
- **File Uploads:** Check Cloudinary configuration

---

**Last Updated:** November 18, 2025  
**Version:** 2.1  
**Status:** âœ… Production Ready

